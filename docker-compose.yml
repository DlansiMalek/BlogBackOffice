version: '2'
services:
    web:
        build:
            context: ./
            dockerfile: web.docker
        volumes:
            - ./:/var/www
        ports:
            - "8083:80"
        links:
            - app
        environment:
            VIRTUAL_HOST: congress-api.vayetek.com
            LETSENCRYPT_HOST: congress-api.vayetek.com
            LETSENCRYPT_EMAIL: vayetek@gmail.com
    app:
        build:
            context: ./
            dockerfile: app.docker
        volumes:
            - ./:/var/www
            - ../../data/congress_data:/var/www/storage/app
            - ./uploads.ini:/usr/local/etc/php/conf.d/uploads.ini
        env_file: .env


networks:
  default:
    external:
      name: nginx-proxy